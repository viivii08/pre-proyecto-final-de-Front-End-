<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jarro Zorrito Invierno - Patagonia Style</title>
  <link rel="icon" type="image/png" href="pages/logo sin fondo (1).png">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
  <link rel="stylesheet" href="styles.css">
  <!-- Frontend Improvements -->
  <link rel="stylesheet" href="css/optimizations.css">
  <link rel="stylesheet" href="css/accessibility.css">
  <link rel="stylesheet" href="css/responsive-advanced.css">
  <link rel="stylesheet" href="css/dark-theme.css">
  <style>
    body {
      background: #f4f1ee;
      font-family: 'Poppins', sans-serif;
      color: #2b2b2b;
    }
    .whatsapp-float {
      position: fixed;
      bottom: 90px;
      right: 20px;
      z-index: 999;
      background: #25d366;
      color: #fff;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.3rem;
      box-shadow: 0 4px 16px rgba(0,0,0,0.18);
      transition: background 0.2s, transform 0.2s;
    }
    .whatsapp-float:hover {
      background: #128c7e;
      color: #fff;
      transform: scale(1.08);
    }
    .producto-section {
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 6px 32px rgba(0,0,0,0.08);
      padding: 2.5rem 2rem;
      margin-top: 2rem;
      margin-bottom: 2rem;
    }
    .producto-gallery {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      align-items: flex-start;
    }
    .producto-gallery img {
      width: 70px;
      height: 70px;
      object-fit: cover;
      border-radius: 10px;
      cursor: pointer;
      border: 2px solid transparent;
      transition: border 0.2s, transform 0.2s;
      box-shadow: 0 2px 8px rgba(0,0,0,0.07);
    }
    .producto-gallery img.active,
    .producto-gallery img:hover {
      border: 2.5px solid #b67c3a;
      transform: scale(1.07);
    }
    .producto-main-img {
      width: 100%;
      max-height: 420px;
      object-fit: cover;
      border-radius: 16px;
      box-shadow: 0 4px 24px rgba(0,0,0,0.10);
      background: #f4f1ee;
      transition: box-shadow 0.2s;
    }
    .producto-precio {
      font-size: 2.2rem;
      color: #3b5d50;
      font-weight: 700;
      letter-spacing: 1px;
    }
    .producto-precio-old {
      text-decoration: line-through;
      color: #aaa;
      font-size: 1.1rem;
      margin-left: 12px;
      font-weight: 500;
    }
    .producto-descuento {
      background: #ffb347;
      color: #fff;
      font-weight: 700;
      border-radius: 8px;
      padding: 4px 14px;
      font-size: 1rem;
      margin-bottom: 12px;
      display: inline-block;
      letter-spacing: 1px;
      box-shadow: 0 2px 8px rgba(255,179,71,0.12);
    }
    .producto-btn {
      background: linear-gradient(90deg, #f4a259 60%, #b67c3a 100%);
      color: #fff;
      font-weight: 600;
      border: none;
      border-radius: 8px;
      padding: 14px 0;
      width: 100%;
      font-size: 1.15rem;
      transition: background 0.2s, transform 0.2s;
      box-shadow: 0 2px 12px rgba(244,162,89,0.10);
      margin-top: 10px;
    }
    .producto-btn:hover {
      background: linear-gradient(90deg, #b67c3a 60%, #f4a259 100%);
      color: #fff;
      transform: translateY(-2px) scale(1.03);
    }
    .producto-stock {
      color: #e67e22;
      font-weight: 600;
      font-size: 1.08rem;
    }
    .producto-envio {
      color: #27ae60;
      font-weight: 500;
      font-size: 1.05rem;
    }
    .producto-cantidad {
      width: 60px;
      text-align: center;
      border-radius: 6px;
      border: 1px solid #ccc;
      margin: 0 8px;
      font-size: 1.1rem;
    }
    .producto-detalle-titulo {
      font-size: 1.35rem;
      font-weight: 700;
      margin-top: 2.5rem;
      color: #3b5d50;
      letter-spacing: 0.5px;
    }
    .producto-detalle {
      font-size: 1.13rem;
      margin-top: 1.1rem;
      color: #444;
      line-height: 1.7;
    }
    .breadcrumb {
      background: none;
      font-size: 1rem;
      margin-bottom: 1.2rem;
    }
    .breadcrumb-item a {
      color: #3b5d50;
      text-decoration: none;
      font-weight: 500;
    }
    .breadcrumb-item.active {
      color: #b67c3a;
      font-weight: 600;
    }
    .input-group input {
      font-size: 1.05rem;
    }
    .input-group .btn {
      font-size: 1.05rem;
    }
    @media (max-width: 991px) {
      .producto-main-img { max-height: 300px; }
      .producto-section { padding: 1.5rem 0.5rem; }
    }
    @media (max-width: 767px) {
      .producto-gallery { flex-direction: row; }
      .producto-main-img { max-height: 220px; }
      .producto-section { padding: 1rem 0.2rem; }
    }
    .navbar .bi-cart3 {
      color: #fff !important;
    }
    footer {
      background: #3b5d50;
      color: #fff;
      text-align: center;
      padding: 2rem 0;
      margin-top: 3rem;
      border-radius: 12px;
      box-shadow: 0 4px 24px rgba(0,0,0,0.15);
    }
    footer p {
      margin: 0.5rem 0;
      font-size: 0.9rem;
    }
    footer a {
      color: #ffb347;
      text-decoration: none;
      font-weight: 500;
    }
    footer a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <!-- Navbar Container -->
  <div id="navbar-container"></div>

  <!-- Producto principal -->
  <main class="container producto-section">
    <div class="row g-4 align-items-start">
      <!-- Galer√≠a lateral -->
      <div class="col-md-1 d-flex flex-md-column flex-row align-items-md-start align-items-center producto-gallery">
        <img src="pages/jarro1.webp" 
             alt="Vista principal del jarro Zorrito Invierno" 
             class="active" 
             onclick="cambiarImagen(this)">
        <img src="pages/jarro2.webp" 
             alt="Vista lateral del jarro Zorrito Invierno" 
             onclick="cambiarImagen(this)">
      </div>
      
      <!-- Imagen principal -->
      <div class="col-md-6">
        <img id="main-img" 
             src="pages/jarro1.webp" 
             alt="Jarro Zorrito Invierno" 
             class="producto-main-img">
      </div>
      
      <!-- Info producto -->
      <div class="col-md-5">
        <!-- Barra de navegaci√≥n prominente -->
        <div class="mb-4 p-3" style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); 
                                     border-radius: 15px; 
                                     border-left: 5px solid #b67c3a;
                                     box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
          <div class="d-flex justify-content-between align-items-center flex-wrap gap-2">
            <!-- Breadcrumb mejorado -->
            <nav aria-label="breadcrumb">
              <ol class="breadcrumb mb-0" style="background: none;">
                <li class="breadcrumb-item">
                  <a href="index.html" style="color: #6c757d; text-decoration: none; font-weight: 500;">
                    <i class="bi bi-house me-1"></i>Inicio
                  </a>
                </li>
                <li class="breadcrumb-item">
                  <a href="tienda.html" style="color: #6c757d; text-decoration: none; font-weight: 500;">
                    <i class="bi bi-shop me-1"></i>Tienda
                  </a>
                </li>
                <li class="breadcrumb-item">
                  <span style="color: #b67c3a; font-weight: 600;">Jarro Zorrito Invierno</span>
                </li>
              </ol>
            </nav>
            
            <!-- Bot√≥n prominente volver a tienda -->
            <a href="tienda.html" class="btn btn-sm" 
               style="background: linear-gradient(135deg, #1f3c5a, #3b5d50); 
                      color: white; 
                      border-radius: 20px; 
                      padding: 8px 16px; 
                      font-weight: 600; 
                      text-decoration: none;
                      font-size: 0.85rem;
                      transition: all 0.3s ease;">
              <i class="bi bi-arrow-left me-1"></i>Volver a Tienda
            </a>
          </div>
        </div>
        
        <!-- Precio y descuento -->
        <div class="d-flex align-items-center mb-2">
          <span class="producto-descuento me-2">8% OFF</span>
          <span class="badge bg-success" style="font-size:0.9rem; font-weight:600;">‚úÖ Disponible (15 unidades)</span>
        </div>
        
        <h2 class="fw-bold mb-3" style="color:#3b5d50;">Jarro Zorrito Invierno</h2>
        
        <div class="mb-3">
          <span class="producto-precio">$21.900</span>
          <span class="producto-precio-old">$23.900</span>
        </div>
        
        <!-- Cantidad y bot√≥n -->
        <div class="d-flex align-items-center mb-3" style="max-width: 300px;">
          <button type="button" class="btn btn-outline-secondary" onclick="cambiarCantidad(-1)">
            <i class="bi bi-dash"></i>
          </button>
          <input type="number" id="cantidad" class="producto-cantidad mx-2" value="1" min="1">
          <button type="button" class="btn btn-outline-secondary" onclick="cambiarCantidad(1)">
            <i class="bi bi-plus"></i>
          </button>
        </div>
        
        <button class="producto-btn" onclick="agregarAlCarrito()">
          <i class="bi bi-cart-plus me-2"></i>Agregar al carrito
        </button>
      </div>
    </div>
    
    <!-- Descripci√≥n del producto -->
    <div class="row mt-5">
      <div class="col-12">
        <h3 class="producto-detalle-titulo">Jarro Zorrito de Invierno</h3>
        <p class="producto-detalle">
          Hermoso jarro enlozado con ilustraci√≥n original de zorrito patag√≥nico en ambiente invernal. 
          Perfecto para tus infusiones favoritas. Material de alta calidad con esmalte duradero y resistente.
        </p>
        <ul class="producto-detalle">
          <li><strong>Material:</strong> Enlozado, resistente y liviano</li>
          <li><strong>Capacidad:</strong> 330ml</li>
          <li><strong>Dise√±o:</strong> Sublimado original de vivipinta, inspirado en la Patagonia</li>
          <li><strong>Ideal para:</strong> Aventuras, camping, hogar y regalar</li>
        </ul>
        <div class="text-center mt-4" style="color:#b67c3a; font-weight:600;">
          ¬°Llev√° la magia de la Patagonia a cada mate!
        </div>
      </div>
    </div>
  </main>

  <!-- Secci√≥n de Testimonios -->
  <section class="container my-5">
    <h2 class="text-center mb-5" style="color: #3b5d50; font-weight: 600;">Testimonios</h2>
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <div class="testimonial-container" style="background: white; border-radius: 15px; padding: 0; box-shadow: 0 8px 25px rgba(0,0,0,0.1); border: 1px solid #f0f0f0; overflow: hidden;">
          <div class="text-center" style="padding: 50px 30px 30px;">
            <div class="mb-4">
              <i class="bi bi-quote" style="font-size: 3rem; color: #ccc; opacity: 0.5;"></i>
            </div>
            <p class="fs-5 mb-4" style="color: #333; line-height: 1.8; font-style: italic; font-weight: 400; max-width: 600px; margin: 0 auto;">
              "Vivi, tus productos son pura magia. Compr√© una libreta y unos jarros enlozados, y cada vez que los uso, siento que me transportan a la Patagonia. La calidad es incre√≠ble y los detalles ilustrados son hermosos."
            </p>
          </div>
          <div style="background: linear-gradient(135deg, #1f3c5a, #3b5d50); padding: 20px; text-align: center;">
            <h5 class="mb-0" style="color: #ffffff !important; font-weight: 700;">Sofia de Buenos Aires</h5>
          </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Secci√≥n de Reviews -->
  <section class="container mt-5">
    <div id="reviews-container">
      <!-- Las reviews se cargan autom√°ticamente aqu√≠ -->
    </div>
  </section>

  <!-- Footer ser√° generado autom√°ticamente por universal-footer.js -->

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      actualizarCarrito();
    });

    function cambiarImagen(img) {
      document.getElementById('main-img').src = img.src;
      document.querySelectorAll('.producto-gallery img').forEach(i => i.classList.remove('active'));
      img.classList.add('active');
    }
    function cambiarCantidad(delta) {
      const input = document.getElementById('cantidad');
      let val = parseInt(input.value) + delta;
      if(val < 1) val = 1;
      input.value = val;
    }
    function agregarAlCarrito() {
      try {
        // üì¶ Datos del producto actual (modelo optimizado)
        const producto = {
          id: 'jarro-zorrito-invierno',
          nombre: "Jarro Zorrito Invierno",
          precio: 21900,
          cantidad: parseInt(document.getElementById('cantidad')?.value || 1),
          imagen: 'pages/jarro1.webp',
          categoria: 'jarros',
          descripcion: 'Jarro de cer√°mica enlozada con ilustraci√≥n de zorrito patag√≥nico',
          // Ejemplo de variantes (si aplicara)
          // variante: { color: 'natural', tama√±o: 'medium' }
        };

        // üõí Usar CarritoManager optimizado
        const result = Carrito.addToCarrito(producto);
        
        if (result.success) {
          // ‚úÖ √âxito: mostrar feedback personalizado
          mostrarNotificacion(result.message, 'success');
          
          // üéØ Animaci√≥n del bot√≥n
          const btn = document.querySelector('.producto-btn');
          animarBotonExito(btn);
          
          // üìä Analytics optimizado
          if (typeof gtag !== 'undefined') {
            gtag('event', 'add_to_cart', {
              currency: 'ARS',
              value: producto.precio * producto.cantidad,
              items: [{
                item_id: producto.id,
                item_name: producto.nombre,
                category: producto.categoria,
                quantity: producto.cantidad,
                price: producto.precio
              }]
            });
          }
          
          // üîî Feedback adicional para actualizaciones
          if (result.action === 'updated') {
            mostrarNotificacion(
              `üìà Cantidad actualizada: ${result.previousQuantity} ‚Üí ${result.newQuantity}`, 
              'info'
            );
          }
          
        } else {
          // ‚ùå Error: mostrar mensaje espec√≠fico del CarritoManager
          mostrarNotificacion(result.message, 'warning');
        }
        
      } catch (error) {
        console.error('‚ùå Error inesperado:', error);
        mostrarNotificacion('‚ùå Error inesperado en el carrito', 'error');
      }
    }

    function actualizarCarrito() {
      // üé® Usar CarritoManager centralizado que maneja TODO:
      // - Contador con animaciones
      // - Lista de productos (si existe)
      // - Totales de precio  
      // - Estados de botones
      Carrito.renderCarrito();
    }

    function mostrarNotificacion(mensaje, tipo = 'info') {
      // Crear o reutilizar contenedor de notificaciones
      let container = document.getElementById('notifications-container');
      if (!container) {
        container = document.createElement('div');
        container.id = 'notifications-container';
        container.style.cssText = `
          position: fixed;
          top: 20px;
          right: 20px;
          z-index: 9999;
          max-width: 400px;
        `;
        document.body.appendChild(container);
      }

      // Crear notificaci√≥n
      const notification = document.createElement('div');
      const iconos = {
        success: '‚úÖ',
        warning: '‚ö†Ô∏è',
        error: '‚ùå',
        info: '‚ÑπÔ∏è'
      };
      
      const colores = {
        success: '#28a745',
        warning: '#ffc107',
        error: '#dc3545',
        info: '#17a2b8'
      };

      notification.innerHTML = `
        <div class="alert alert-dismissible fade show" 
             style="background: ${colores[tipo]}; 
                    color: white; 
                    border: none; 
                    border-radius: 10px;
                    box-shadow: 0 4px 20px rgba(0,0,0,0.2);
                    margin-bottom: 10px;">
          <span>${iconos[tipo]} ${mensaje}</span>
          <button type="button" class="btn-close btn-close-white" 
                  onclick="this.parentElement.parentElement.remove()"></button>
        </div>
      `;

      container.appendChild(notification);

      // Auto-remove despu√©s de 5 segundos
      setTimeout(() => {
        if (notification.parentElement) {
          notification.remove();
        }
      }, 5000);

      // Animaci√≥n de entrada
      notification.style.transform = 'translateX(100%)';
      notification.style.transition = 'transform 0.3s ease';
      setTimeout(() => {
        notification.style.transform = 'translateX(0)';
      }, 100);
    }

    function animarBotonExito(boton) {
      if (!boton) return;

      const originalText = boton.innerHTML;
      const originalStyle = boton.style.cssText;

      // Cambiar apariencia temporalmente
      boton.innerHTML = '<i class="bi bi-check-circle me-2"></i>¬°Agregado!';
      boton.style.background = 'linear-gradient(90deg, #28a745, #20c997)';
      boton.style.transform = 'scale(1.05)';

      // Restaurar despu√©s de 2 segundos
      setTimeout(() => {
        boton.innerHTML = originalText;
        boton.style.cssText = originalStyle;
      }, 2000);
    }
  </script>

  <script>
    console.log('üçØ [jarro.html] P√°gina cargada correctamente');
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- Nuevos sistemas de gesti√≥n -->
  <script src="js/storage/StorageManager.js"></script>
  <script src="js/forms/DynamicFormManager.js"></script>
  <script src="js/carrito/CarritoManager.js"></script>
  
  <script src="js/store.js"></script>
  <script src="js/users.js"></script>
  <script src="js/universal-navbar.js"></script>
  <script src="js/frontend-utils.js"></script>
  <script src="js/reviews.js"></script>
  
  <!-- Inicializar navbar universal -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      window.universalNavbar = new UniversalNavbar();
    });
  </script>

  <!-- Modales universales -->
  <script src="js/universal-modals.js"></script>

  <script src="js/whatsapp-global.js"></script>
  <!-- Sistema de Footer Universal -->
  <script src="js/universal-footer.js"></script>
</body>
</html>