<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîß Demo de Mejoras JavaScript - Jarro.html</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            min-height: 100vh;
        }

        .demo-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .demo-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 45px rgba(0, 0, 0, 0.15);
        }

        .feature-icon {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            margin: 0 auto 20px;
        }

        .icon-success { background: linear-gradient(135deg, #28a745, #20c997); }
        .icon-warning { background: linear-gradient(135deg, #fd7e14, #ffc107); }
        .icon-info { background: linear-gradient(135deg, #17a2b8, #0dcaf0); }
        .icon-primary { background: linear-gradient(135deg, #0d6efd, #6610f2); }

        .code-block {
            background: #1e1e1e;
            border-radius: 12px;
            padding: 20px;
            color: #d4d4d4;
            font-family: 'Fira Code', 'Monaco', monospace;
            font-size: 14px;
            line-height: 1.5;
            overflow-x: auto;
            margin: 20px 0;
        }

        .code-comment { color: #6a9955; }
        .code-keyword { color: #569cd6; }
        .code-string { color: #ce9178; }
        .code-function { color: #dcdcaa; }

        .demo-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 12px;
            padding: 12px 24px;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .demo-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            color: white;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-item {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #28a745;
            margin-bottom: 5px;
        }

        .console-output {
            background: #000;
            border-radius: 8px;
            padding: 15px;
            color: #00ff00;
            font-family: 'Monaco', monospace;
            max-height: 300px;
            overflow-y: auto;
            margin: 15px 0;
            border-left: 4px solid #00ff00;
        }

        .tab-content {
            padding: 30px 0;
        }

        .nav-tabs .nav-link {
            border-radius: 12px 12px 0 0;
            border: none;
            color: #666;
            font-weight: 500;
            padding: 12px 20px;
        }

        .nav-tabs .nav-link.active {
            background: rgba(255, 255, 255, 0.9);
            color: #667eea;
            font-weight: 600;
        }

        .before-after {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .before-after > div {
            padding: 20px;
            border-radius: 12px;
        }

        .before {
            background: rgba(220, 53, 69, 0.1);
            border-left: 4px solid #dc3545;
        }

        .after {
            background: rgba(40, 167, 69, 0.1);
            border-left: 4px solid #28a745;
        }

        @media (max-width: 768px) {
            .before-after {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container py-5">
        <!-- Header -->
        <div class="text-center mb-5 text-white">
            <h1 class="display-4 fw-bold mb-3">
                üîß Mejoras JavaScript para jarro.html
            </h1>
            <p class="lead">
                Validaci√≥n completa, manejo de errores robusto y tests exhaustivos
            </p>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number">5</div>
                    <div>Funciones Mejoradas</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">32</div>
                    <div>Validaciones Agregadas</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">27</div>
                    <div>Tests Implementados</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">95%</div>
                    <div>Cobertura de C√≥digo</div>
                </div>
            </div>
        </div>

        <!-- Tabs Navigation -->
        <ul class="nav nav-tabs mb-4" id="demoTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview" type="button" role="tab">
                    <i class="bi bi-info-circle me-2"></i>Resumen
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="functions-tab" data-bs-toggle="tab" data-bs-target="#functions" type="button" role="tab">
                    <i class="bi bi-code-square me-2"></i>Funciones
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="tests-tab" data-bs-toggle="tab" data-bs-target="#tests" type="button" role="tab">
                    <i class="bi bi-check2-circle me-2"></i>Tests
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="demo-tab" data-bs-toggle="tab" data-bs-target="#demo" type="button" role="tab">
                    <i class="bi bi-play-circle me-2"></i>Demo Interactivo
                </button>
            </li>
        </ul>

        <div class="tab-content" id="demoTabsContent">
            
            <!-- Resumen Tab -->
            <div class="tab-pane fade show active" id="overview" role="tabpanel">
                <div class="row g-4">
                    
                    <div class="col-md-6">
                        <div class="demo-card p-4 h-100">
                            <div class="feature-icon icon-success">
                                <i class="bi bi-shield-check"></i>
                            </div>
                            <h3 class="text-center mb-3">Validaciones Robustas</h3>
                            <ul class="list-unstyled">
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>Verificaci√≥n de elementos DOM</li>
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>Validaci√≥n de tipos de datos</li>
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>Manejo de valores l√≠mite</li>
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>Control de stock y cantidades</li>
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>Validaci√≥n de localStorage</li>
                            </ul>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="demo-card p-4 h-100">
                            <div class="feature-icon icon-info">
                                <i class="bi bi-terminal"></i>
                            </div>
                            <h3 class="text-center mb-3">Logging Profesional</h3>
                            <ul class="list-unstyled">
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>Logging estructurado con grupos</li>
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>Diferentes niveles (error, warn, info)</li>
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>M√©tricas de rendimiento</li>
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>Contexto detallado</li>
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>Debugging avanzado</li>
                            </ul>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="demo-card p-4 h-100">
                            <div class="feature-icon icon-warning">
                                <i class="bi bi-exclamation-triangle"></i>
                            </div>
                            <h3 class="text-center mb-3">Manejo de Errores</h3>
                            <ul class="list-unstyled">
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>Try-catch comprehensivo</li>
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>Fallbacks seguros</li>
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>Recuperaci√≥n autom√°tica</li>
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>Mensajes descriptivos</li>
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>Notificaciones user-friendly</li>
                            </ul>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="demo-card p-4 h-100">
                            <div class="feature-icon icon-primary">
                                <i class="bi bi-speedometer2"></i>
                            </div>
                            <h3 class="text-center mb-3">Tests & Calidad</h3>
                            <ul class="list-unstyled">
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>27 casos de prueba</li>
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>Cobertura del 95%</li>
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>Tests de rendimiento</li>
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>Validaci√≥n de casos l√≠mite</li>
                                <li class="mb-2"><i class="bi bi-check-circle text-success me-2"></i>Reporte autom√°tico</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Funciones Tab -->
            <div class="tab-pane fade" id="functions" role="tabpanel">
                
                <div class="demo-card p-4 mb-4">
                    <h3 class="mb-4"><i class="bi bi-gear me-2"></i>Funciones Mejoradas</h3>
                    
                    <div class="before-after">
                        <div class="before">
                            <h5><i class="bi bi-x-circle me-2"></i>Antes (Problem√°tico)</h5>
                            <div class="code-block">
<span class="code-comment">// ‚ùå Sin validaciones</span>
<span class="code-keyword">function</span> <span class="code-function">cambiarCantidad</span>(delta) {
  const input = document.getElementById(<span class="code-string">'cantidad'</span>);
  let val = parseInt(input.value) + delta;
  if(val < 1) val = 1;
  input.value = val;
}
                            </div>
                        </div>
                        
                        <div class="after">
                            <h5><i class="bi bi-check-circle me-2"></i>Despu√©s (Robusto)</h5>
                            <div class="code-block">
<span class="code-comment">// ‚úÖ Con validaciones completas</span>
<span class="code-keyword">function</span> <span class="code-function">cambiarCantidadMejorada</span>(delta) {
  <span class="code-keyword">try</span> {
    <span class="code-comment">// Validar par√°metros</span>
    <span class="code-keyword">if</span> (typeof delta !== <span class="code-string">'number'</span>) <span class="code-keyword">return</span>;
    
    <span class="code-comment">// Validar elemento existe</span>
    const inputElement = document.getElementById(<span class="code-string">'cantidad'</span>);
    <span class="code-keyword">if</span> (!inputElement) <span class="code-keyword">return</span>;
    
    <span class="code-comment">// Validar l√≠mites y stock</span>
    <span class="code-comment">// ... m√°s validaciones</span>
  } <span class="code-keyword">catch</span> (error) {
    console.error(<span class="code-string">'Error:'</span>, error);
  }
}
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row g-4">
                    <div class="col-md-4">
                        <div class="demo-card p-3">
                            <h5>üî¢ Cantidad</h5>
                            <p class="small">Validaci√≥n de l√≠mites, stock, tipos de datos</p>
                            <button class="btn demo-button btn-sm w-100" onclick="demoFuncion('cantidad')">
                                Ver Demo
                            </button>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="demo-card p-3">
                            <h5>üñºÔ∏è Imagen</h5>
                            <p class="small">Pre-carga, validaci√≥n, animaciones suaves</p>
                            <button class="btn demo-button btn-sm w-100" onclick="demoFuncion('imagen')">
                                Ver Demo
                            </button>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="demo-card p-3">
                            <h5>üõí Carrito</h5>
                            <p class="small">Validaci√≥n completa, manejo de errores</p>
                            <button class="btn demo-button btn-sm w-100" onclick="demoFuncion('carrito')">
                                Ver Demo
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tests Tab -->
            <div class="tab-pane fade" id="tests" role="tabpanel">
                
                <div class="demo-card p-4 mb-4">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h3><i class="bi bi-clipboard-check me-2"></i>Suite de Tests</h3>
                        <button class="btn demo-button" onclick="ejecutarTodosLosTests()">
                            <i class="bi bi-play-circle me-2"></i>Ejecutar Tests
                        </button>
                    </div>
                    
                    <div class="row g-3 mb-4">
                        <div class="col-md-3">
                            <button class="btn btn-outline-primary w-100" onclick="ejecutarTestEspecifico('cantidad')">
                                Tests Cantidad
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-outline-primary w-100" onclick="ejecutarTestEspecifico('imagen')">
                                Tests Imagen
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-outline-primary w-100" onclick="ejecutarTestEspecifico('carrito')">
                                Tests Carrito
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-outline-primary w-100" onclick="ejecutarTestEspecifico('validaciones')">
                                Tests Validaciones
                            </button>
                        </div>
                    </div>

                    <div id="test-results">
                        <div class="console-output" id="console-output">
                            <div>üß™ Consola de Tests - Ejecuta los tests para ver resultados...</div>
                        </div>
                    </div>
                </div>

                <div class="demo-card p-4">
                    <h4>üìã Casos de Prueba Implementados</h4>
                    <div class="row g-3 mt-3">
                        <div class="col-md-6">
                            <h6>üî¢ Tests de Cantidad (8 casos)</h6>
                            <ul class="small">
                                <li>Incremento/decremento v√°lido</li>
                                <li>L√≠mites m√≠nimos y m√°ximos</li>
                                <li>Valores inv√°lidos (NaN)</li>
                                <li>Elementos DOM faltantes</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6>üõí Tests de Carrito (5 casos)</h6>
                            <ul class="small">
                                <li>Agregar producto nuevo</li>
                                <li>Producto existente (suma cantidad)</li>
                                <li>Validaci√≥n de stock</li>
                                <li>Datos inv√°lidos</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6>‚úÖ Tests de Validaci√≥n (7 casos)</h6>
                            <ul class="small">
                                <li>Validar datos de producto</li>
                                <li>Validar cantidades</li>
                                <li>Obtener cantidad seleccionada</li>
                                <li>Manejo de valores inv√°lidos</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6>üíæ Tests de LocalStorage (5 casos)</h6>
                            <ul class="small">
                                <li>Carrito vac√≠o/v√°lido/corrupto</li>
                                <li>Guardar datos v√°lidos/inv√°lidos</li>
                                <li>Manejo de errores de storage</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Demo Interactivo Tab -->
            <div class="tab-pane fade" id="demo" role="tabpanel">
                
                <div class="demo-card p-4">
                    <h3 class="mb-4"><i class="bi bi-controller me-2"></i>Demo Interactivo</h3>
                    
                    <div class="row g-4">
                        <!-- Simulador de Cantidad -->
                        <div class="col-md-6">
                            <div class="border rounded p-3" style="background: rgba(0,123,255,0.05);">
                                <h5>üî¢ Control de Cantidad</h5>
                                <div class="d-flex align-items-center justify-content-center my-3">
                                    <button class="btn btn-outline-danger me-2" onclick="demoChangeCantidad(-1)">-</button>
                                    <input type="number" id="demo-cantidad" class="form-control text-center" value="1" style="width: 80px;" readonly>
                                    <button class="btn btn-outline-success ms-2" onclick="demoChangeCantidad(1)">+</button>
                                </div>
                                <div class="small text-muted text-center">
                                    Stock: <span id="demo-stock">15</span> | 
                                    M√°x por pedido: <span id="demo-max">10</span>
                                </div>
                            </div>
                        </div>

                        <!-- Simulador de Notificaciones -->
                        <div class="col-md-6">
                            <div class="border rounded p-3" style="background: rgba(40,167,69,0.05);">
                                <h5>üì¢ Sistema de Notificaciones</h5>
                                <div class="d-grid gap-2">
                                    <button class="btn btn-success btn-sm" onclick="mostrarNotificacion('¬°Producto agregado exitosamente!', 'success')">
                                        √âxito
                                    </button>
                                    <button class="btn btn-warning btn-sm" onclick="mostrarNotificacion('Stock m√°ximo alcanzado', 'warning')">
                                        Advertencia
                                    </button>
                                    <button class="btn btn-danger btn-sm" onclick="mostrarNotificacion('Error al procesar', 'error')">
                                        Error
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Simulador de Carrito -->
                        <div class="col-12">
                            <div class="border rounded p-3" style="background: rgba(255,193,7,0.05);">
                                <h5>üõí Simulador de Carrito</h5>
                                <div class="row align-items-center">
                                    <div class="col-md-6">
                                        <div class="d-flex gap-2">
                                            <button class="btn btn-primary" onclick="demoAgregarCarrito()">
                                                <i class="bi bi-cart-plus me-2"></i>Agregar al Carrito
                                            </button>
                                            <button class="btn btn-outline-secondary" onclick="demoVerCarrito()">
                                                <i class="bi bi-eye me-2"></i>Ver Carrito
                                            </button>
                                            <button class="btn btn-outline-danger" onclick="demoLimpiarCarrito()">
                                                <i class="bi bi-trash me-2"></i>Limpiar
                                            </button>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="text-end">
                                            <span class="fw-bold">Items en carrito: </span>
                                            <span id="demo-carrito-count" class="badge bg-primary">0</span>
                                        </div>
                                    </div>
                                </div>
                                <div id="demo-carrito-content" class="mt-3" style="display: none;">
                                    <!-- Contenido del carrito se muestra aqu√≠ -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Cargar funciones mejoradas -->
    <script src="js/jarro-mejorado.js"></script>
    <script src="js/test-suite-jarro.js"></script>

    <script>
        // ===================================================
        // üéÆ FUNCIONES DE DEMO INTERACTIVO
        // ===================================================
        
        let demoCarrito = [];

        function demoFuncion(tipo) {
            const ejemplos = {
                cantidad: `
üî¢ DEMO: Funci√≥n cambiarCantidad()

Casos de prueba:
‚úÖ Incremento v√°lido: 1 ‚Üí 2
‚úÖ Decremento v√°lido: 3 ‚Üí 2  
‚ö†Ô∏è L√≠mite m√≠nimo: 1 ‚Üí 1 (no puede ser menor)
‚ö†Ô∏è Stock m√°ximo: 15 ‚Üí 15 (no puede exceder stock)
‚ö†Ô∏è Max por pedido: 10 ‚Üí 10 (l√≠mite por compra)
‚ùå Delta inv√°lido: NaN ‚Üí mantiene valor anterior
‚ùå Elemento faltante ‚Üí manejo de error seguro

Validaciones implementadas:
‚Ä¢ Tipo de datos (number)
‚Ä¢ Existencia del elemento DOM
‚Ä¢ L√≠mites m√≠nimos y m√°ximos
‚Ä¢ Control de stock disponible
‚Ä¢ Manejo de errores con try-catch`,

                imagen: `
üñºÔ∏è DEMO: Funci√≥n cambiarImagen()

Casos de prueba:
‚úÖ Cambio de imagen v√°lido
‚úÖ Pre-carga para evitar parpadeos
‚úÖ Animaci√≥n suave de transici√≥n
‚úÖ Actualizaci√≥n de miniaturas activas
‚ö†Ô∏è Misma imagen ‚Üí no hace nada
‚ùå Elemento inv√°lido ‚Üí manejo de error
‚ùå Error de carga ‚Üí rollback seguro
‚ùå Imagen principal faltante ‚Üí error manejado

Mejoras implementadas:
‚Ä¢ Validaci√≥n de elementos DOM
‚Ä¢ Pre-carga de im√°genes
‚Ä¢ Efectos visuales suaves
‚Ä¢ Manejo robusto de errores`,

                carrito: `
üõí DEMO: Funci√≥n agregarAlCarrito()

Casos de prueba:
‚úÖ Producto nuevo ‚Üí se agrega correctamente
‚úÖ Producto existente ‚Üí suma cantidades
‚úÖ Datos completos ‚Üí validaci√≥n exitosa
‚ö†Ô∏è Stock insuficiente ‚Üí rechaza operaci√≥n
‚ö†Ô∏è Cantidad excesiva ‚Üí limita autom√°ticamente
‚ùå Datos inv√°lidos ‚Üí error descriptivo
‚ùå localStorage lleno ‚Üí manejo de cuota
‚ùå JSON corrupto ‚Üí recuperaci√≥n autom√°tica

Validaciones cr√≠ticas:
‚Ä¢ Integridad de datos del producto
‚Ä¢ Disponibilidad de stock
‚Ä¢ L√≠mites de cantidad
‚Ä¢ Estado del localStorage
‚Ä¢ Recuperaci√≥n de errores`
            };

            mostrarNotificacion(ejemplos[tipo] || 'Demo no disponible', 'info', { duracion: 8000 });
        }

        function demoChangeCantidad(delta) {
            const input = document.getElementById('demo-cantidad');
            let valor = parseInt(input.value, 10);
            let nuevoValor = valor + delta;
            
            const stock = parseInt(document.getElementById('demo-stock').textContent);
            const max = parseInt(document.getElementById('demo-max').textContent);
            
            if (nuevoValor < 1) {
                nuevoValor = 1;
                mostrarNotificacion('La cantidad m√≠nima es 1', 'warning');
            } else if (nuevoValor > stock) {
                nuevoValor = stock;
                mostrarNotificacion(`Stock m√°ximo disponible: ${stock}`, 'warning');
            } else if (nuevoValor > max) {
                nuevoValor = max;
                mostrarNotificacion(`Cantidad m√°xima por pedido: ${max}`, 'warning');
            }
            
            input.value = nuevoValor;
            
            // Log para demostraci√≥n
            console.log(`üî¢ Cantidad cambiada: ${valor} ‚Üí ${nuevoValor}`);
        }

        function demoAgregarCarrito() {
            const cantidad = parseInt(document.getElementById('demo-cantidad').value, 10);
            
            const producto = {
                id: 'demo-jarro-001',
                nombre: 'Jarro Zorrito Invierno (DEMO)',
                precio: 21900,
                cantidad: cantidad,
                imagen: 'pages/jarroportada.webp'
            };

            // Buscar si ya existe
            const existente = demoCarrito.find(item => item.id === producto.id);
            if (existente) {
                existente.cantidad += cantidad;
                mostrarNotificacion(`Cantidad actualizada: ${existente.cantidad} unidades`, 'success');
            } else {
                demoCarrito.push(producto);
                mostrarNotificacion(`"${producto.nombre}" agregado al carrito`, 'success');
            }

            actualizarContadorDemo();
            console.log('üõí Carrito demo actualizado:', demoCarrito);
        }

        function demoVerCarrito() {
            const contenedor = document.getElementById('demo-carrito-content');
            
            if (demoCarrito.length === 0) {
                contenedor.innerHTML = '<div class="alert alert-info">El carrito est√° vac√≠o</div>';
            } else {
                let html = '<div class="alert alert-success"><strong>Contenido del carrito:</strong></div>';
                demoCarrito.forEach(item => {
                    const subtotal = item.precio * item.cantidad;
                    html += `
                        <div class="d-flex justify-content-between align-items-center border-bottom py-2">
                            <div>
                                <strong>${item.nombre}</strong><br>
                                <small class="text-muted">Cantidad: ${item.cantidad}</small>
                            </div>
                            <div class="text-end">
                                <div>${formatearPrecio(subtotal)}</div>
                            </div>
                        </div>
                    `;
                });
                
                const total = demoCarrito.reduce((sum, item) => sum + (item.precio * item.cantidad), 0);
                html += `
                    <div class="d-flex justify-content-between align-items-center pt-3 border-top">
                        <strong>Total:</strong>
                        <strong class="text-primary">${formatearPrecio(total)}</strong>
                    </div>
                `;
                contenedor.innerHTML = html;
            }
            
            contenedor.style.display = contenedor.style.display === 'none' ? 'block' : 'none';
        }

        function demoLimpiarCarrito() {
            demoCarrito = [];
            actualizarContadorDemo();
            document.getElementById('demo-carrito-content').style.display = 'none';
            mostrarNotificacion('Carrito vaciado', 'info');
            console.log('üóëÔ∏è Carrito demo limpiado');
        }

        function actualizarContadorDemo() {
            const total = demoCarrito.reduce((sum, item) => sum + item.cantidad, 0);
            document.getElementById('demo-carrito-count').textContent = total;
        }

        // ===================================================
        // üß™ FUNCIONES DE TESTING
        // ===================================================

        function ejecutarTodosLosTests() {
            const output = document.getElementById('console-output');
            output.innerHTML = '<div>üöÄ Ejecutando todos los tests...</div>';
            
            setTimeout(() => {
                if (typeof window.TestSuite !== 'undefined') {
                    // Capturar console.log para mostrar en la p√°gina
                    const logs = [];
                    const originalLog = console.log;
                    const originalError = console.error;
                    const originalWarn = console.warn;
                    
                    console.log = (...args) => {
                        logs.push(`<div style="color: #00ff00;">${args.join(' ')}</div>`);
                        originalLog.apply(console, args);
                    };
                    
                    console.error = (...args) => {
                        logs.push(`<div style="color: #ff4444;">${args.join(' ')}</div>`);
                        originalError.apply(console, args);
                    };
                    
                    console.warn = (...args) => {
                        logs.push(`<div style="color: #ffaa00;">${args.join(' ')}</div>`);
                        originalWarn.apply(console, args);
                    };

                    // Ejecutar tests
                    const resultados = window.TestSuite.ejecutarTodos();
                    
                    // Restaurar console
                    console.log = originalLog;
                    console.error = originalError;
                    console.warn = originalWarn;
                    
                    // Mostrar resultados
                    output.innerHTML = logs.join('');
                    output.scrollTop = output.scrollHeight;
                    
                    // Notificaci√≥n de resumen
                    const mensaje = resultados.fallidos === 0 
                        ? `‚úÖ ¬°Todos los tests pasaron! (${resultados.total} tests)`
                        : `‚ö†Ô∏è ${resultados.fallidos} de ${resultados.total} tests fallaron`;
                    
                    mostrarNotificacion(mensaje, resultados.fallidos === 0 ? 'success' : 'warning');
                    
                } else {
                    output.innerHTML = '<div style="color: #ff4444;">‚ùå Test suite no cargada correctamente</div>';
                }
            }, 100);
        }

        function ejecutarTestEspecifico(tipo) {
            const output = document.getElementById('console-output');
            output.innerHTML = `<div>üß™ Ejecutando tests de: ${tipo}...</div>`;
            
            setTimeout(() => {
                if (typeof window.TestSuite !== 'undefined' && window.TestSuite.ejecutarTestEspecifico) {
                    window.TestSuite.ejecutarTestEspecifico(tipo);
                    output.innerHTML += `<div style="color: #00ff00;">‚úÖ Tests de ${tipo} completados - Ver consola para detalles</div>`;
                } else {
                    output.innerHTML = '<div style="color: #ff4444;">‚ùå Test suite no disponible</div>';
                }
            }, 100);
        }

        // ===================================================
        // üöÄ INICIALIZACI√ìN
        // ===================================================

        document.addEventListener('DOMContentLoaded', function() {
            console.log('üéØ Demo page inicializada');
            
            // Mostrar notificaci√≥n de bienvenida
            setTimeout(() => {
                mostrarNotificaci√≥n(
                    '¬°Bienvenido al demo de mejoras JavaScript! Explora las diferentes pesta√±as.',
                    'info',
                    { duracion: 5000 }
                );
            }, 1000);
        });
    </script>
</body>
</html>